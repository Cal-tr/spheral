set(PYB11_MODULE_NAME Physics)
include(UsePYB11Generator)
PYB11_GENERATE_BINDINGS()

set(MODULE_INCLUDES
  ${PROJECT_SOURCE_DIR}/src/${PYB11_MODULE_NAME}
  ${PROJECT_SOURCE_DIR}/src
  )

set(MODULE_NAME Spheral${PYB11_MODULE_NAME})
set(GENERATED_SOURCE Spheral${PYB11_GENERATED_SOURCE})
set(ADDITIONAL_SOURCES )
set(ADDITIONAL_DEPENDS )

blt_add_library(
  NAME         ${MODULE_NAME}
  SOURCES      ${GENERATED_SOURCE} ${ADDITIONAL_SOURCES}
#  DEPENDS_ON   ${SPHERAL_PYTHON_DEPENDS} ${ADDITIONAL_DEPENDS} ${spheral_depends}
  INCLUDES     ${MODULE_INCLUDES}
  OUTPUT_NAME  ${MODULE_NAME}
  CLEAR_PREFIX TRUE
  SHARED       TRUE
  )

set_target_properties(${MODULE_NAME} PROPERTIES
  IMPORTED_LINK_INTERFACE_MULTIPLICITY 5)

target_link_libraries(
  ${MODULE_NAME}
  -Wl,--start-group
  ${SPHERAL_PYTHON_DEPENDS}
  -Wl,--end-group
  ${ADDITIONAL_DEPENDS}
  )

install(
  FILES ${CMAKE_BINARY_DIR}/lib/$<TARGET_FILE_NAME:${MODULE_NAME}>
  DESTINATION .
  )
